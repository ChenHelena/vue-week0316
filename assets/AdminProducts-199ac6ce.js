import{_ as g,o as n,c as i,d as t,k as c,l as r,F as b,g as U,j as M,p as C,f as x,t as p,q as y,n as k,M as V,r as P,e as w}from"./index-acd9cc3d.js";const $={props:["tempProduct","isNew","updateProduct"],data(){return{product:{}}},methods:{addImages(){this.product.imagesUrl=[],this.product.imagesUrl.push("")}},watch:{tempProduct(){this.product=this.tempProduct}}},D={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},E={class:"modal-header bg-dark text-white"},A={id:"productModalLabel",class:"modal-title"},T={key:0},L={key:1},I=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},B={class:"row"},S={class:"col-sm-4"},j={class:"mb-3"},z=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),F=["src"],H={key:0},O=t("h4",null,"多圖處理",-1),q=["onUpdate:modelValue"],G=["src"],J={key:0,class:"my-3"},K={key:1},Q={key:1,class:"my-3"},W={class:"col-sm-8"},X={class:"mb-3"},Y=t("label",{for:"title",class:"form-label"},"標題",-1),Z={class:"row"},tt={class:"mb-3 col-md-6"},et=t("label",{for:"category",class:"form-label"},"分類",-1),ot={class:"mb-3 col-md-6"},st=t("label",{for:"price",class:"form-label"},"單位",-1),lt={class:"row"},dt={class:"mb-3 col-md-6"},nt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),it={class:"mb-3 col-md-6"},at=t("label",{for:"price",class:"form-label"},"售價",-1),ct=t("hr",null,null,-1),rt={class:"mb-3"},ut=t("label",{for:"description",class:"form-label"},"產品描述",-1),pt={class:"mb-3"},mt=t("label",{for:"content",class:"form-label"},"說明內容",-1),_t={class:"mb-3"},ht={class:"form-check"},bt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),gt={class:"modal-footer"},ft=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function vt(l,e,d,f,o,a){return n(),i("div",D,[t("div",N,[t("div",E,[t("h5",A,[d.isNew?(n(),i("span",T,"新增產品")):(n(),i("span",L,"編輯產品"))]),I]),t("div",R,[t("div",B,[t("div",S,[t("div",j,[z,c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.product.imageUrl=s),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[r,o.product.imageUrl]]),t("img",{class:"img-fluid",src:o.product.imageUrl},null,8,F)]),Array.isArray(o.product.imagesUrl)?(n(),i("div",H,[O,(n(!0),i(b,null,U(o.product.imagesUrl,(s,m)=>(n(),i(b,{key:m+1},[c(t("input",{"onUpdate:modelValue":v=>o.product.imagesUrl[m]=v,type:"text",class:"form-control"},null,8,q),[[r,o.product.imagesUrl[m]]]),t("img",{src:o.product.imagesUrl[m],alt:"",class:"img-fluid mt-3"},null,8,G)],64))),128)),!o.product.imagesUrl.length||o.product.imagesUrl[o.product.imagesUrl.length-1]?(n(),i("div",J,[t("button",{onClick:e[1]||(e[1]=()=>o.product.imagesUrl.push("")),class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")])):M("",!0),o.product.imagesUrl.length?(n(),i("div",K,[t("button",{onClick:e[2]||(e[2]=()=>o.product.imagesUrl.pop("")),class:"btn btn-outline-danger btn-sm d-block w-100"}," 刪除圖片 ")])):M("",!0)])):(n(),i("div",Q,[t("button",{onClick:e[3]||(e[3]=(...s)=>l.createImages&&l.createImages(...s)),class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")]))]),t("div",W,[t("div",X,[Y,c(t("input",{id:"title","onUpdate:modelValue":e[4]||(e[4]=s=>o.product.title=s),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[r,o.product.title]])]),t("div",Z,[t("div",tt,[et,c(t("input",{id:"category","onUpdate:modelValue":e[5]||(e[5]=s=>o.product.category=s),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[r,o.product.category]])]),t("div",ot,[st,c(t("input",{id:"unit","onUpdate:modelValue":e[6]||(e[6]=s=>o.product.unit=s),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[r,o.product.unit]])])]),t("div",lt,[t("div",dt,[nt,c(t("input",{id:"origin_price","onUpdate:modelValue":e[7]||(e[7]=s=>o.product.origin_price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[r,o.product.origin_price,void 0,{number:!0}]])]),t("div",it,[at,c(t("input",{id:"price","onUpdate:modelValue":e[8]||(e[8]=s=>o.product.price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[r,o.product.price,void 0,{number:!0}]])])]),ct,t("div",rt,[ut,c(t("textarea",{id:"description","onUpdate:modelValue":e[9]||(e[9]=s=>o.product.description=s),type:"text",class:"form-control",placeholder:"請輸入產品描述"},`\r
              `,512),[[r,o.product.description]])]),t("div",pt,[mt,c(t("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=s=>o.product.content=s),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`\r
              `,512),[[r,o.product.content]])]),t("div",_t,[t("div",ht,[c(t("input",{id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=s=>o.product.is_enabled=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[C,o.product.is_enabled]]),bt])])])])]),t("div",gt,[ft,t("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=(...s)=>d.updateProduct&&d.updateProduct(...s))}," 確認 ")])])])}const yt=g($,[["render",vt]]),kt={props:{item:{}},emits:["del-modal"]},Pt={class:"modal-dialog"},wt={class:"modal-content border-0"},Ut=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt={class:"modal-body"},xt={class:"text-danger"},Vt={class:"modal-footer"},Ct=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function $t(l,e,d,f,o,a){return n(),i("div",Pt,[t("div",wt,[Ut,t("div",Mt,[x(" 確定要刪除 "),t("strong",xt,p(d.item.title),1),x("？(刪除後將無法恢復)。 ")]),t("div",Vt,[Ct,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=()=>l.$emit("del-modal"))}," 確認刪除 ")])])])}const Dt=g(kt,[["render",$t]]),Nt={props:["pages"],methods:{updatePage(l){this.$emit("emitPages",l)}}},Et={"aria-label":"Page navigation example"},At={class:"pagination justify-content-center"},Tt=t("span",{"aria-hidden":"true"},"«",-1),Lt=[Tt],It={key:0,class:"page-link"},Rt=["onClick"],Bt=t("span",{"aria-hidden":"true"},"»",-1),St=[Bt];function jt(l,e,d,f,o,a){return n(),i("nav",Et,[t("ul",At,[t("li",{class:y([{disabled:!d.pages.has_pre},"page-item"])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=k(()=>a.updatePage(d.pages.current_page-1),["prevent"]))},Lt)],2),(n(!0),i(b,null,U(d.pages.total_pages,s=>(n(),i("li",{class:y(["page-item",{active:d.pages.current_page===s}]),key:s},[s===d.pages.current_page?(n(),i("span",It,p(s),1)):(n(),i("a",{key:1,class:"page-link",href:"#",onClick:k(()=>a.updatePage(s),["prevent"])},p(s),9,Rt))],2))),128)),t("li",{class:y(["page-item",{disabled:!d.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=k(()=>a.updatePage(d.pages.current_page+1),["prevent"]))},St)],2)])])}const zt=g(Nt,[["render",jt]]),{VITE_URL:_,VITE_PATH:h}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"helena27",BASE_URL:"/vue-week0316/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ft={data(){return{products:[],tempProduct:{imageUrl:[]},isNew:!1,page:{}}},components:{ProductModal:yt,DelProductModal:Dt,PaginationView:zt},methods:{checkAdmin(){const l=`${_}api/user/check`;this.$http.post(l).then(e=>{e.data.success&&this.$router.push("/admin/products")}).catch(()=>{this.$router.push("/login")})},getData(l=1){const e=`${_}api/${h}/admin/products?page=${l}`;this.$http.get(e).then(d=>{this.products=d.data.products,this.page=d.data.pagination}).catch(d=>{console.log(d.response.data.message)})},openModal(l,e){l==="delete"?(this.tempProduct={...e},this.delProductModal.show()):l==="edit"?(this.isNew=!1,this.tempProduct={...e},this.productModal.show(),console.log(this.tempProduct)):l==="new"&&(this.isNew=!0,this.tempProduct={imagesUrl:[]},this.productModal.show())},updateProduct(){let l=`${_}api/${h}/admin/product`,e="post";this.isNew||(l=`${_}api/${h}/admin/product/${this.tempProduct.id}`,e="put"),this.$http[e](l,{data:this.tempProduct}).then(d=>{alert(d.data.message),this.productModal.hide(),this.getData()}).catch(d=>{alert(d.response.data)})},deleteProduct(){const l=`${_}api/${h}/admin/product/${this.tempProduct.id}`;this.$http.delete(l).then(e=>{alert(e.data.message),this.delProductModal.hide(),this.getData()}).catch(e=>{alert(e.data)})}},mounted(){this.getData(),this.productModal=new V("#productModal"),this.delProductModal=new V("#delProductModal"),this.checkAdmin();const l=document.cookie.replace(/(?:(?:^|.*;\s*)helenaToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=l}},Ht={class:"container"},Ot={class:"text-end mt-4"},qt={class:"table mt-4"},Gt=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),Jt={class:"text-end"},Kt={class:"text-end"},Qt={key:0,class:"text-success"},Wt={key:1},Xt={class:"btn-group"},Yt=["onClick"],Zt=["onClick"],te={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},ee={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"};function oe(l,e,d,f,o,a){const s=P("PaginationView"),m=P("product-modal"),v=P("del-product-modal");return n(),i("div",Ht,[t("div",Ot,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=()=>a.openModal("new"))}," 建立新的產品 ")]),t("table",qt,[Gt,t("tbody",null,[(n(!0),i(b,null,U(o.products,u=>(n(),i("tr",{key:u.id},[t("td",null,p(u.category),1),t("td",null,p(u.title),1),t("td",Jt,p(u.origin_price),1),t("td",Kt,p(u.price),1),t("td",null,[u.is_enabled?(n(),i("span",Qt,"啟用")):(n(),i("span",Wt,"未啟用"))]),t("td",null,[t("div",Xt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>a.openModal("edit",u)}," 編輯 ",8,Yt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>a.openModal("delete",u)}," 刪除 ",8,Zt)])])]))),128))])]),w(s,{pages:o.page,onEmitPages:a.getData},null,8,["pages","onEmitPages"]),t("div",te,[w(m,{"is-new":o.isNew,"temp-product":o.tempProduct,"update-product":a.updateProduct},null,8,["is-new","temp-product","update-product"])],512),t("div",ee,[w(v,{item:o.tempProduct,onDelModal:a.deleteProduct},null,8,["item","onDelModal"])],512)])}const le=g(Ft,[["render",oe]]);export{le as default};
